<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WS Test Local</title>
</head>
<body>
  <div id="log">INIT</div>

  <script>
    const PC_HOST = "localhost";     // ★ ローカルテストなので localhost 固定
    const PC_PORT = 8765;           // ★ server.py と同じ 8765
    const WS_URL = `ws://${PC_HOST}:${PC_PORT}`;

    const logEl = document.getElementById("log");

    function log(text, color = "black") {
      logEl.textContent = text;
      logEl.style.color = color;
      console.log(text);
    }

    log("CONNECTING " + WS_URL + " ...");

    const ws = new WebSocket(WS_URL);

    ws.onopen = () => {
      log("CONNECTED " + WS_URL, "green");
      ws.send(JSON.stringify({ hello: "world" }));
    };

    ws.onmessage = (ev) => {
      log("RECV " + ev.data, "blue");
    };

    ws.onerror = (ev) => {
      log("ERROR", "red");
      console.log("ws error", ev);
    };

    ws.onclose = () => {
      log("CLOSED", "orange");
    };
  </script>
</body>
</html>
